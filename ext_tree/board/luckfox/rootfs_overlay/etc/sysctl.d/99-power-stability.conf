# RV1106 Power Stability Optimizations
# General settings to handle poor power quality and voltage jitter

# === CPU & Scheduler Optimizations ===
# Reduce CPU load spikes to minimize power consumption peaks
kernel.sched_min_granularity_ns = 10000000
kernel.sched_wakeup_granularity_ns = 15000000
kernel.sched_migration_cost_ns = 5000000
kernel.sched_nr_migrate = 8

# Disable hung task detector (false positives during voltage drops)
kernel.hung_task_timeout_secs = 0
kernel.hung_task_warnings = 0

# === Memory Management ===
# Reduce memory pressure and I/O load
vm.min_free_kbytes = 16384
vm.swappiness = 1
vm.vfs_cache_pressure = 50
vm.dirty_background_ratio = 5
vm.dirty_ratio = 10
vm.dirty_expire_centisecs = 6000
vm.dirty_writeback_centisecs = 1500

# === Network & I/O Buffers ===
# Larger buffers to handle transient interruptions
net.core.rmem_default = 262144
net.core.rmem_max = 16777216
net.core.wmem_default = 262144
net.core.wmem_max = 16777216
net.core.netdev_max_backlog = 5000

# === Filesystem & Storage ===
# Reduce filesystem sync pressure
fs.file-max = 65536
fs.nr_open = 1048576

# === Power Management ===
# Disable some power management features that can cause instability
kernel.printk_delay = 0
kernel.timer_migration = 1